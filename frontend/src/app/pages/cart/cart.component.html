<section class="section" aria-label="Shopping cart">
  <div class="container">
    <h1 class="section-title">Shopping <span>Cart</span></h1>

    <!-- Empty cart -->
    <div *ngIf="items.length === 0" class="empty-state text-center">
      <p style="font-size: 3rem" aria-hidden="true">ðŸ›’</p>
      <h3>Your cart is empty</h3>
      <p class="text-muted">Discover authentic Jamaican products.</p>
      <a routerLink="/shop" class="btn btn-primary mt-md">Browse Shop</a>
    </div>

    <!-- Cart items -->
    <div *ngIf="items.length > 0" class="cart-layout">
      <div class="cart-items">
        <article class="cart-item" *ngFor="let item of items">
          <img
            [src]="item.product.image_url"
            [alt]="item.product.name"
            class="cart-item__img"
            loading="lazy"
          />
          <div class="cart-item__info">
            <h3>
              <a [routerLink]="['/shop', item.product.id]">{{
                item.product.name
              }}</a>
            </h3>
            <p class="text-muted" style="font-size: 0.85rem">
              {{ item.product.category }}
            </p>
            <p class="cart-item__price">
              Â£{{ item.product.price | number: "1.2-2" }}
            </p>
          </div>
          <div class="cart-item__qty">
            <button
              class="btn btn-ghost btn-sm"
              (click)="updateQty(item.product.id, item.quantity - 1)"
              aria-label="Decrease"
            >
              âˆ’
            </button>
            <span>{{ item.quantity }}</span>
            <button
              class="btn btn-ghost btn-sm"
              (click)="updateQty(item.product.id, item.quantity + 1)"
              aria-label="Increase"
            >
              +
            </button>
          </div>
          <div class="cart-item__subtotal">
            Â£{{ item.product.price * item.quantity | number: "1.2-2" }}
          </div>
          <button
            class="btn btn-ghost btn-sm"
            (click)="remove(item.product.id)"
            [attr.aria-label]="'Remove ' + item.product.name"
          >
            âœ•
          </button>
        </article>
      </div>

      <!-- Summary -->
      <aside class="cart-summary" aria-label="Order summary">
        <h3>Order Summary</h3>
        <div class="summary-row">
          <span>Items ({{ totalItems }})</span
          ><span>Â£{{ totalPrice | number: "1.2-2" }}</span>
        </div>
        <div class="summary-row">
          <span>Shipping</span><span class="text-green">Free</span>
        </div>
        <hr />
        <div class="summary-row total">
          <span>Total</span><span>Â£{{ totalPrice | number: "1.2-2" }}</span>
        </div>
        <button
          class="btn btn-accent btn-lg"
          style="width: 100%; margin-top: var(--space-lg)"
          (click)="checkout()"
          [disabled]="checkingOut"
        >
          {{ checkingOut ? "Placing orderâ€¦" : "Place Order" }}
        </button>
        <div
          *ngIf="orderSuccess"
          class="alert alert-success mt-md"
          role="alert"
        >
          Order placed successfully! <a routerLink="/orders">View orders</a>
        </div>
        <div *ngIf="orderError" class="alert alert-error mt-md" role="alert">
          {{ orderError }}
        </div>
      </aside>
    </div>
  </div>
</section>
